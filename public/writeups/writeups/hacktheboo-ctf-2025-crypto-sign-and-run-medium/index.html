<!DOCTYPE html>
<html><head lang="en">
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>HackTheBoo CTF 2025 | Crypto: Sign and Run [medium] - moeve&#39;s blog</title><link rel="icon" type="image/x-icon" href="/favicon2.8f68632c487952c29fd770f908f1910c2adc7ffbb78ffd0c71771bca8c5b71e1.ico" /><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Reverse-engineering the Iron Scribe service and brute-forcing its 32-bit CRC seal to recover the flag." />
	<meta property="og:image" content=""/>
	<script>
	(function () {
		var storageKey = 'theme';
		var classList = document.documentElement.classList;
		var storedTheme = null;
		try {
			storedTheme = window.localStorage.getItem(storageKey);
		} catch (err) {
			storedTheme = null;
		}
		var prefersDark = false;
		try {
			prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
		} catch (err) {
			prefersDark = false;
		}
		var theme = (storedTheme === 'dark' || storedTheme === 'light') ? storedTheme : (prefersDark ? 'dark' : 'light');
		if (theme === 'dark') {
			classList.add('dark');
		} else {
			classList.remove('dark');
		}
	})();
	</script>
	<script type="module" src="https://diemoeve.github.io/js/theme-toggle.js" defer></script>
	<meta property="og:url" content="https://diemoeve.github.io/writeups/writeups/hacktheboo-ctf-2025-crypto-sign-and-run-medium/">
  <meta property="og:site_name" content="moeve&#39;s blog">
  <meta property="og:title" content="HackTheBoo CTF 2025 | Crypto: Sign and Run [medium]">
  <meta property="og:description" content="Reverse-engineering the Iron Scribe service and brute-forcing its 32-bit CRC seal to recover the flag.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeups">
    <meta property="article:published_time" content="2025-10-27T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-10-27T00:00:00+00:00">
    <meta property="article:tag" content="HackTheBox">
    <meta property="article:tag" content="HackTheBoo 2025">
    <meta property="article:tag" content="Cryptography">
    <meta property="article:tag" content="RSA">
    <meta property="article:tag" content="Python">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="HackTheBoo CTF 2025 | Crypto: Sign and Run [medium]">
  <meta name="twitter:description" content="Reverse-engineering the Iron Scribe service and brute-forcing its 32-bit CRC seal to recover the flag.">

        <link href="https://diemoeve.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://diemoeve.github.io/css/main.7a5c05040394322612a2d98397e9932aa81d9d7acc70199463e79f8180c8e0c0.css" />
		
		
		<link rel="stylesheet" type="text/css" href="https://diemoeve.github.io/css/custom.07f912777db42e88a413bca7f38a722b56303b2914ca91d86ae3341cccc44ed5.css">
		
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://diemoeve.github.io/">moeve&#39;s blog</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/writeups/">Writeups</a>
		
		<a href="/tags/">Tags</a>
		
		<button id="theme-toggle" class="theme-toggle" type="button" aria-label="Switch to dark mode" aria-pressed="false">
			<svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
				<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
			</svg>
			<svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
				<circle cx="12" cy="12" r="5"></circle>
				<line x1="12" y1="1" x2="12" y2="3"></line>
				<line x1="12" y1="21" x2="12" y2="23"></line>
				<line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
				<line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
				<line x1="1" y1="12" x2="3" y2="12"></line>
				<line x1="21" y1="12" x2="23" y2="12"></line>
				<line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
				<line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
			</svg>
		</button>
	</nav>
</header>

<main>
  <article>
    <div class="post-container">
      
      <div class="post-content">
        <div class="title">
          <h1 class="title">HackTheBoo CTF 2025 | Crypto: Sign and Run [medium]</h1>
          <div class="meta">Posted on Oct 27, 2025</div>
        </div>
        
        <section class="body">
          <p>At the edge of Hollow Mere stands an ancient automaton known as the Iron Scribe - a machine that writes commands in living metal and executes only those sealed with a valid mark. The Scribe&rsquo;s master key was lost ages ago, but its forges still hum, stamping glyphs of permission into every order it receives. Willem approaches the machine&rsquo;s console, where it offers a bargain: &ldquo;Sign your words, and I shall act. Present a forged seal, and be undone.&rdquo; To awaken the Scribe&rsquo;s obedience, one must understand how its mark is made&hellip; and how to make it lie.</p>
<h2 id="step-1--understanding-the-scribe">Step 1 – Understanding the Scribe</h2>
<p>Connecting with <code>nc 46.101.173.67 32368</code> shows a banner with a 2048-bit RSA modulus every session. Reading <code>server.py</code>:</p>
<pre tabindex="0"><code>pt = bytes_to_long(cmd)
ct = pow(pt, d, N)
sig = crc32(long_to_bytes(ct))
print(f&#34;Encrypted signature: {pow(sig, e, N)}&#34;)
</code></pre><p>During <code>invoke</code>, the service recomputes that same 32-bit <code>sig</code> and compares it with the user-supplied seal. Nothing more.. no PKCS#1 padding, no blind signing, just an RSA-encrypted CRC32. That means the only “secret” is a 32-bit integer; once you invert <code>pow(sig, e, N)</code> you can run arbitrary commands.</p>
<h2 id="step-2--early-attempts">Step 2 – Early Attempts</h2>
<p>I tried several angles before brute-forcing:</p>
<ul>
<li>Attempted to send raw binary/UTF-8 commands hoping to influence <code>bytes_to_long</code>; the server happily accepted anything but always hashed the RSA “decryption” with CRC32.</li>
<li>Dug through older RSA write-ups (blind signatures, PKCS#1 laxness, multiplicative tricks). All require the service to issue signatures on chosen messages. Here, you only ever get RSA applied to the <em>CRC</em>, not the command itself, so there’s nothing algebraic to exploit.</li>
</ul>
<p>So despite the lore hinting at “forging a mark,” the only viable solution I found is to brute-force the 32-bit CRC directly.</p>
<h2 id="step-3--high-throughput-brute-force">Step 3 – High-Throughput Brute Force</h2>
<p>I wrote the brute-forcer in C using GMP:</p>
<pre tabindex="0"><code>mpz_powm_ui(result, base, 65537, N);
if (mpz_cmp(result, target) == 0) { ... }
</code></pre><p>Each thread walks a dedicated slice of the 0..2^32 range, and a shared flag stops the pool once any thread finds the match. Compiled with <code>gcc brute_gmp.c -O3 -march=native -lgmp -lpthread</code>, this reaches ~1.5M powmods/sec per core on my machine.</p>
<p><code>exploit.py</code> keeps the socket alive while <code>brute_gmp</code> runs. As soon as a candidate seal is found, it sends <code>invoke cat&lt;/flag.txt &lt;sig&gt;</code> over that same connection and prints the flag.</p>
<p><em>I won&rsquo;t upload the code here, as I believe there is a quicker soltuion, but for that you will have to look for the official writeup from HTB</em></p>
<h2 id="step-4--results">Step 4 – Results</h2>
<p>After far too many retries—and eventually renting a beefier VPS because my own machine would have taken roughly 4× longer—the brute-force finally succeeded:</p>
<pre tabindex="0"><code>[+] Found signature: 4161569746
[+] Time taken: 3772.00 seconds (62.87 minutes)
</code></pre><pre tabindex="0"><code>HTB{w3_sh0u1d_m3333333t_1n_th3_m1dd13!!!!!_cc66053315777e798944cdbf28cf9836}
</code></pre><h2 id="closing-thoughts">Closing Thoughts</h2>
<p>Despite the flavor text hinting at an elegant “forgery”, the practical exploit is a high-speed search over 2^32 RSA encryptions. It works, but it feels more like a hardware contest. I’m still waiting for the official HTB write-up to see whether there’s a smarter way.</p>

        </section>
        <div class="post-tags">
          
          
          <nav class="nav tags">
            <ul class="tags">
              
              <li><a href="/tags/hackthebox">HackTheBox</a></li>
              
              <li><a href="/tags/hacktheboo-2025">HackTheBoo 2025</a></li>
              
              <li><a href="/tags/cryptography">Cryptography</a></li>
              
              <li><a href="/tags/rsa">RSA</a></li>
              
              <li><a href="/tags/python">Python</a></li>
              
            </ul>
          </nav>
          
          
        </div>
      </div>

      
      
    </div>

    </article>
</main>
<footer>
  <div style="display:flex"></div>
  <div class="footer-info">
    © 2025 moeve · Theme based on <a href="https://github.com/athul/archie">Archie</a> (MIT)
  </div>
</footer>



</div>
    </body>
</html>
